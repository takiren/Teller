# TellerEngine
なんかノベルゲーム用のエンジン作ってます。
いつ完成するんでしょうか。
将来的にノードベースで進行管理するノベルゲームエンジンになる予定です。

## Overview
* TellerEngineがメインのプロジェクトフォルダ。
* 使用しているサブモジュールはCinder, json, fast-cpp-csv-parser。それ以外を使う予定は今のところない。

## ブランチについて
* master  
  ビルドが通ってるやつ安定版、てきな。
* develop/*  
  機能追加してるやつ。
* [その他]  
  意味はないブランチ。

## 技術選定
* C++  
    将来的にマルチプラットフォーム対応したいためどこでも動くC++を採用。Chromiumやなんらかのオープンソースブラウザをバックエンドにしてjavascriptで実装するスタイルでもよかったが、   Javascriptは1ヶ月ぐらい仲良くしていたためC++で決行。
* Cinder  
  OpenGLのラッパー。  低レベルで扱いやすく、マルチプラットフォーム対応、なおかつ2Dにも対応しているライブラリだったため採用。
* その他ライブラリ  
  実績が多いものを採用。  
  例
  * jsonパーサー
  * csvパーサー


## 設計

グラフィックライブラリにOpenGLラッパーのCinderを使用。
マルチプラットフォーム対応を見据えできるだけ環境依存しないように標準ライブラリを使用して構築。

スマートポインタを使いそこそこスマートな実装になっている。

<img src="images\ClassDiagram.png">

すべての機能をモジュールという単位に分解して機能拡張しやすくする。　　
ModuleCoreを継承したモジュール群をすべてのモジュールを管理するTellerCoreクラスに登録する。

これによりエディターとゲームを別々に作らず開発できる。  
配布するためにはまた別の処理が必要ではある。

<img src=images\Stack.png>

ゲーム内で動くオブジェクトはAgentクラスから派生したもの。

## 進捗
* モジュールシステムの大枠の実装が終わった。
* CSVを読み込めるようになった。
* 非同期処理を行うためのスレッドプールの実装が終わった。
* ノードエディタ用のノードの実装が終わった。

## 今後の計画。
* ノードエディタ実装。
* imgui-node-editorをそのまま組み込もうか思案中。
* レンダラーの非同期処理。

## モジュール管理の実装について。
スマートポインタで木構造を実装している。  
各モジュールは親を一つ(TellerCoreを除く)、子を複数持つ。
親への参照をweak_ptrで持ち子はshared_ptrで持つ。
理論上は親モジュールが所有権を放棄したらそれ以下のモジュールはスマートポインタによって
適切にdeleteされる。

>TellerEngine\Core.h

## 謝辞
先駆者の方々ありがとうございます。そしてこれからもお世話になります。

## 命名規則
+ クラス内で使用する変数は末尾にアンダースコアを極力使用。
+ 引数で与えられる紛らわしい引数は接頭辞にアンダースコアを使用。